<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Règne de Dieu — Live</title>
  <meta name="description" content="Site bilingue (FR/EN) pour la diffusion en direct des cultes et événements de l'Église Règne de Dieu via intégration iframe." />
  <meta name="robots" content="index, follow">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f8fafc;        /* gris très clair */
      --card: #ffffff;      /* blanc */
      --text: #0f172a;      /* bleu nuit */
      --muted: #475569;     /* gris/bleuté */
      --primary: #1d4ed8;   /* bleu doux */
      --accent: #eab308;    /* doré */
      --soft: #e2e8f0;      /* soft border */
      --heart: #ef4444;     /* red */
      --shadow: 0 10px 30px rgba(2, 6, 23, 0.08);
      --radius-xl: 20px;
    }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body {
      margin: 0; font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color: var(--text);
      background: linear-gradient(180deg, #ffffff 0%, var(--bg) 100%);
    }
    header {
      position: sticky; top: 0; z-index: 20;
      background: rgba(255,255,255,0.75); backdrop-filter: saturate(180%) blur(12px);
      border-bottom: 1px solid var(--soft);
    }
    .container { width: min(1100px, 92vw); margin: 0 auto; }
    .row { display: flex; align-items: center; justify-content: space-between; gap: 16px; padding: 14px 0; }
    .brand { display:flex; align-items:center; gap:12px; text-decoration:none; color:inherit }
    .logo {
      width: 40px; height: 40px; border-radius: 50%; display:grid; place-items:center; 
      background: linear-gradient(135deg, var(--accent), #fde68a);
      box-shadow: var(--shadow);
      font-weight: 800; color: #4d3600;
    }
    .title { font-weight: 800; letter-spacing: 0.2px; }
    .lang-switch { display:flex; align-items:center; gap:8px; }
    .lang-switch button {
      border: 1px solid var(--soft); background: var(--card); color: var(--muted);
      padding: 8px 12px; border-radius: 999px; cursor: pointer; transition: all .2s ease;
    }
    .lang-switch button.active { color: var(--text); border-color: var(--primary); box-shadow: 0 0 0 3px rgba(29,78,216,.12) }

    main { padding: 28px 0 80px; }

    .hero { display:grid; gap: 22px; }
    .player-card { background: var(--card); border:1px solid var(--soft); border-radius: var(--radius-xl); box-shadow: var(--shadow); overflow:hidden }
    .player-aspect { position:relative; width:100%; padding-top: 56.25%; background:#000 }
    .player-aspect iframe, .player-aspect .placeholder { position:absolute; inset:0; width:100%; height:100%; border:0; }
    .placeholder { display:grid; place-items:center; color:#cbd5e1; font-weight:600; letter-spacing:.3px; background:
      radial-gradient(ellipse at top, #0b1022 0%, #020617 60%),
      url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="90" viewBox="0 0 160 90"><g fill="none" stroke="%231c2a56" stroke-width="1"><rect x="1" y="1" width="158" height="88" rx="8"/><path d="M1 64h158M1 32h158M80 1v88"/></g></svg>') center/contain no-repeat;
    }
    .player-actions { display:flex; align-items:center; justify-content:space-between; padding: 12px 14px; border-top:1px solid var(--soft); background: #fbfdff }
    .left-actions { display:flex; align-items:center; gap:12px }
    .like-btn { display:flex; align-items:center; gap:8px; padding:10px 14px; border-radius: 999px; border:1px solid var(--soft); background: var(--card); cursor:pointer; transition:.2s; }
    .like-btn:hover { transform: translateY(-1px); box-shadow: var(--shadow) }
    .like-btn .heart { width:18px; height:18px; display:inline-block }

    .grid { display:grid; gap:22px; grid-template-columns: 1.2fr .8fr; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr } }

    .card { background: var(--card); border: 1px solid var(--soft); border-radius: var(--radius-xl); box-shadow: var(--shadow); padding: 18px; }
    h1 { font-size: clamp(22px, 3vw, 30px); margin:0 }
    h2 { font-size: 20px; margin: 0 0 10px 0 }
    p { color: var(--muted); line-height: 1.6 }
    ul { margin: 0; padding-left: 18px; color: var(--muted) }

    /* Hidden admin access dot */
    .admin-dot {
      position: fixed; right: 14px; bottom: 14px; width: 14px; height: 14px; border-radius: 50%; cursor: pointer; z-index: 40;
      background: radial-gradient(circle at 30% 30%, #fde68a, var(--accent));
      box-shadow: 0 6px 16px rgba(234,179,8,.32), inset 0 0 0 2px rgba(0,0,0,.06);
      transition: transform .15s ease;
    }
    .admin-dot:hover { transform: scale(1.08) }

    /* Modals */
    .modal { position: fixed; inset: 0; display:none; align-items:center; justify-content:center; z-index: 50; backdrop-filter: blur(4px); }
    .modal.open { display:flex }
    .modal .panel { width: min(560px, 92vw); background: var(--card); border:1px solid var(--soft); border-radius: 16px; box-shadow: var(--shadow); overflow:hidden }
    .modal header { position:relative; border-bottom: 1px solid var(--soft); background: #fff }
    .modal .panel .body { padding: 16px; }
    .close-x { position:absolute; right:12px; top:10px; border:0; background:transparent; font-size:22px; cursor:pointer; color:var(--muted) }

    .form-row { display:grid; gap:10px; margin:10px 0 }
    textarea, input[type="text"], input[type="password"] { width:100%; padding:12px 12px; border:1px solid var(--soft); border-radius: 12px; font: inherit; }
    textarea { min-height: 140px; resize: vertical }
    .btn {
      display:inline-flex; align-items:center; justify-content:center; gap:10px; cursor:pointer; border: 1px solid var(--soft);
      padding: 10px 14px; border-radius: 12px; background: var(--primary); color: #fff; font-weight:600; box-shadow: var(--shadow);
    }
    .btn.outline { background:#fff; color: var(--primary) }
    .notice { padding: 10px 12px; border:1px dashed var(--soft); border-radius: 12px; background:#fcfcfd; color: var(--muted); font-size: 14px }
    .success { color: #047857 }
    .error { color: #b91c1c }
    footer { padding: 36px 0; text-align:center; color: var(--muted); }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="row">
        <a class="brand" href="#" aria-label="Accueil">
          <div class="logo">RDD</div>
          <div>
            <div class="title">Règne de Dieu</div>
            <small id="subtitle" style="color:var(--muted)">Diffusion en direct</small>
          </div>
        </a>
        <div class="lang-switch" role="group" aria-label="Sélection de la langue / Language">
          <button id="lang-fr" class="active" data-lang="fr" aria-pressed="true">FR</button>
          <button id="lang-en" data-lang="en" aria-pressed="false">EN</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="container hero">
      <section class="player-card" aria-label="Lecteur vidéo">
        <div class="player-aspect" id="player">
          <div class="placeholder" id="placeholder">
            <div style="text-align:center">
              <div style="font-size: clamp(16px, 2.2vw, 22px); margin-bottom:6px" data-i18n="placeholder_title">Le live débutera ici</div>
              <div style="font-size: 13px; opacity:.9" data-i18n="placeholder_hint">Collez le code d'intégration (iframe) dans l'admin pour démarrer.</div>
            </div>
          </div>
        </div>
        <div class="player-actions">
          <div class="left-actions">
            <button class="like-btn" id="likeBtn" aria-live="polite">
              <svg class="heart" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" xmlns="http://www.w3.org/2000/svg">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
              </svg>
              <span id="likeText" data-i18n="like">J'aime</span>
              <strong id="likeCount">0</strong>
            </button>
          </div>
          <div class="right-actions" style="display:flex; align-items:center; gap:8px">
            <span style="font-size:13px; color:var(--muted)" data-i18n="powered"></span>
          </div>
        </div>
      </section>

      <section class="grid" aria-label="Informations et sections">
        <article class="card">
          <h1 data-i18n="welcome_title">Bienvenue à l'Église Règne de Dieu</h1>
          <p data-i18n="welcome_body">Nous sommes une communauté unie dans la foi, la louange et le service. Rejoignez-nous pour vivre des moments de prière, d'enseignement et de célébration, en présence ou en ligne.</p>
          <ul>
            <li data-i18n="point1">Diffusion en direct des cultes et événements.</li>
          </ul>
        </article>
      </section>
    </div>
  </main>

  <footer>
    <div class="container">© <span id="year"></span> Règne de Dieu — <span data-i18n="rights">Tous droits réservés.</span></div>
  </footer>

  <!-- Hidden admin access dot -->
  <div class="admin-dot" id="adminDot" title="Admin"></div>

  <!-- Login Modal -->
  <div class="modal" id="loginModal" aria-hidden="true" aria-labelledby="loginTitle" role="dialog">
    <div class="panel">
      <header class="row container">
        <h2 id="loginTitle" style="margin:10px 0" data-i18n="login_title">Connexion administrateur</h2>
        <button class="close-x" data-close="loginModal" aria-label="Fermer">×</button>
      </header>
      <div class="body">
        <div class="form-row">
          <label for="username" data-i18n="label_user">Nom d'utilisateur</label>
          <input type="text" id="username" placeholder="root" autocomplete="username" />
        </div>
        <div class="form-row">
          <label for="password" data-i18n="label_pass">Mot de passe</label>
          <input type="password" id="password" placeholder="rdd2025" autocomplete="current-password" />
        </div>
        <div class="form-row" style="display:flex; gap:10px; align-items:center">
          <button class="btn" id="loginBtn" data-i18n="btn_login">Se connecter</button>
          <span id="loginMsg" class="error" role="status" aria-live="polite"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Panel Modal -->
  <div class="modal" id="adminModal" aria-hidden="true" aria-labelledby="adminTitle" role="dialog">
    <div class="panel">
      <header class="row container">
        <h2 id="adminTitle" style="margin:10px 0" data-i18n="admin_title">Panneau d'administration</h2>
        <button class="close-x" data-close="adminModal" aria-label="Fermer">×</button>
      </header>
      <div class="body">
        <p class="notice" data-i18n="admin_notice">Collez ci-dessous le code &lt;iframe&gt; complet fourni par Facebook ou YouTube. Seule la balise &lt;iframe&gt; est acceptée.</p>
        <div class="form-row">
          <label for="iframeInput" data-i18n="label_iframe">Code d'intégration (iframe)</label>
          <textarea id="iframeInput" placeholder="&lt;iframe src='https://...' allowfullscreen&gt;&lt;/iframe&gt;"></textarea>
        </div>
        <div class="form-row" style="display:flex; gap:10px; align-items:center; flex-wrap: wrap;">
          <button class="btn" id="applyBtn" data-i18n="btn_update">Mettre à jour le live</button>
          <button class="btn outline" id="clearBtn" data-i18n="btn_clear">Effacer le lecteur</button>
          <span id="applyMsg" class="success" role="status" aria-live="polite"></span>
          <!-- Bouton de retour vers la page Live -->
<button class="btn outline" id="returnLiveBtn">⬅ Retour au Live</button>

        </div>
      </div>
    </div>
  </div>

  <script>
    // --- i18n dictionary ---
    const I18N = {
      fr: {
        subtitle: "Diffusion en direct",
        placeholder_title: "Le live débutera ici",
        placeholder_hint: "Collez le code d'intégration (iframe) dans l'admin pour démarrer.",
        like: "J'aime",
        powered: "Propulsé par un simple iframe",
        welcome_title: "Bienvenue à l'Église Règne de Dieu",
        welcome_body: "Nous sommes une communauté unie dans la foi, la louange et le service. Rejoignez-nous pour vivre des moments de prière, d'enseignement et de célébration, en présence ou en ligne.",
        point1: "Diffusion en direct des cultes et événements.",
        point2: "Interface simple, épurée et accessible.",
        point3: "Compatible Facebook Live & YouTube Live.",
        how_title: "Comment démarrer le live ?",
        how_body: "Cliquez sur le point doré en bas à droite, connectez-vous, puis collez le code d'intégration (iframe) fourni par Facebook ou YouTube. Validez pour mettre à jour le lecteur.",
        rights: "Tous droits réservés.",
        login_title: "Connexion administrateur",
        label_user: "Nom d'utilisateur",
        label_pass: "Mot de passe",
        btn_login: "Se connecter",
        admin_title: "Panneau d'administration",
        admin_notice: "Collez ci-dessous le code <iframe> complet fourni par Facebook ou YouTube. Seule la balise <iframe> est acceptée.",
        label_iframe: "Code d'intégration (iframe)",
        btn_update: "Mettre à jour le live",
        btn_clear: "Effacer le lecteur"
      },
      en: {
        subtitle: "Live streaming",
        placeholder_title: "The live will start here",
        placeholder_hint: "Paste the embed (iframe) code in admin to start.",
        like: "Like",
        powered: "Powered by a simple iframe",
        welcome_title: "Welcome to 'Règne de Dieu' Church",
        welcome_body: "We are a community united in faith, worship and service. Join us to experience prayer, teaching and celebration, on-site or online.",
        point1: "Live streaming of services and events.",
        point2: "Simple, clean and accessible interface.",
        point3: "Compatible with Facebook Live & YouTube Live.",
        how_title: "How to start the live?",
        how_body: "Click the golden dot at the bottom-right, login, then paste the embed (iframe) code from Facebook or YouTube. Apply to update the player.",
        rights: "All rights reserved.",
        login_title: "Administrator login",
        label_user: "Username",
        label_pass: "Password",
        btn_login: "Sign in",
        admin_title: "Admin panel",
        admin_notice: "Paste the full <iframe> code provided by Facebook or YouTube below. Only the <iframe> tag is accepted.",
        label_iframe: "Embed code (iframe)",
        btn_update: "Update live",
        btn_clear: "Clear player"
      }
    };

    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    const langButtons = [$('#lang-fr'), $('#lang-en')];
    const subtitle = $('#subtitle');
    const yearSpan = $('#year');
    const likeBtn = $('#likeBtn');
    const likeCountEl = $('#likeCount');
    const likeText = $('#likeText');
    const adminDot = $('#adminDot');
    const loginModal = $('#loginModal');
    const adminModal = $('#adminModal');
    const loginBtn = $('#loginBtn');
    const loginMsg = $('#loginMsg');
    const applyBtn = $('#applyBtn');
    const clearBtn = $('#clearBtn');
    const applyMsg = $('#applyMsg');

    const username = $('#username');
    const password = $('#password');
    const iframeInput = $('#iframeInput');
    const player = $('#player');
    const placeholder = $('#placeholder');

    let currentLang = localStorage.getItem('lang') || 'fr';

    // --- Language switch ---
    function applyLang(lang) {
      currentLang = lang;
      localStorage.setItem('lang', lang);
      langButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.lang === lang));
      $$('[data-i18n]').forEach(node => {
        const key = node.getAttribute('data-i18n');
        const value = I18N[lang][key] || node.textContent;
        node.textContent = value;
      });
      subtitle.textContent = I18N[lang].subtitle;
      document.documentElement.lang = lang;
      document.title = (lang === 'fr' ? 'Règne de Dieu — Live' : "Reigne de Dieu — Live");
    }

    langButtons.forEach(btn => btn.addEventListener('click', () => applyLang(btn.dataset.lang)));

    // --- Year ---
    yearSpan.textContent = new Date().getFullYear();

    // --- Likes (client-side only) ---
    function getLikes() { return parseInt(localStorage.getItem('likes') || '0', 10); }
    function setLikes(v) { localStorage.setItem('likes', String(v)); likeCountEl.textContent = v; }
    setLikes(getLikes());
    likeBtn.addEventListener('click', () => {
      const cur = getLikes() + 1; setLikes(cur);
      likeBtn.classList.add('pulse');
      likeBtn.style.borderColor = 'rgba(239, 68, 68, .3)';
      setTimeout(() => { likeBtn.style.borderColor = 'var(--soft)'; likeBtn.classList.remove('pulse'); }, 350);
    });

    // --- Modals helpers ---
    function openModal(el) { el.classList.add('open'); el.setAttribute('aria-hidden', 'false'); }
    function closeModal(el) { el.classList.remove('open'); el.setAttribute('aria-hidden', 'true'); }

    adminDot.addEventListener('click', () => openModal(loginModal));
    $$('[data-close]').forEach(btn => btn.addEventListener('click', (e)=> {
      const id = btn.getAttribute('data-close'); const m = document.getElementById(id); if (m) closeModal(m);
    }));

    window.addEventListener('keydown', (e)=>{
      if (e.key === 'Escape') { [loginModal, adminModal].forEach(closeModal); }
    });

    // --- Simple front-end auth (demo only) ---
    function isAuthed() { return sessionStorage.getItem('authed') === '1'; }
    function setAuthed(v) { sessionStorage.setItem('authed', v ? '1' : '0'); }

    loginBtn.addEventListener('click', () => {
      loginMsg.textContent = '';
      const u = username.value.trim();
      const p = password.value.trim();
      if (u === 'root' && p === 'rdd2025') {
        setAuthed(true);
        closeModal(loginModal);
        username.value = ''; password.value = '';
        openModal(adminModal);
      } else {
        loginMsg.textContent = (currentLang === 'fr' ? 'Identifiants incorrects.' : 'Invalid credentials.');
      }
    });

    // --- Iframe validation and apply ---
    function sanitizeAndExtractIframe(html) {
      try {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        // Accept first iframe only
        const ifr = doc.querySelector('iframe');
        if (!ifr) return { ok:false, msg: currentLang === 'fr' ? 'Aucune balise <iframe> trouvée.' : 'No <iframe> tag found.' };

        // Clone to avoid moving nodes between docs
        const clean = document.createElement('iframe');
        // Only allow safe attributes
        const allowed = ['src','width','height','allow','allowfullscreen','loading','referrerpolicy','title','frameborder'];
        for (const attr of allowed) {
          if (ifr.hasAttribute(attr)) clean.setAttribute(attr, ifr.getAttribute(attr));
        }
        // Enforce sandboxing defaults (optional; comment if platform requires permissions)
        // clean.setAttribute('sandbox', 'allow-scripts allow-same-origin allow-presentation');
        clean.setAttribute('allowfullscreen', '');
        clean.style.width = '100%';
        clean.style.height = '100%';

        // Basic src validation
        const src = clean.getAttribute('src') || '';
        const okSrc = /^(https?:)?\/\//i.test(src);
        if (!okSrc) return { ok:false, msg: currentLang === 'fr' ? 'Attribut src invalide dans l\'iframe.' : 'Invalid iframe src attribute.' };

        return { ok:true, node: clean };
      } catch (e) {
        return { ok:false, msg: e.message };
      }
    }

    function mountIframe(node) {
      player.innerHTML = '';
      const wrap = document.createElement('div');
      wrap.className = 'player-aspect';
      wrap.appendChild(node);
      player.replaceWith(wrap);
      wrap.id = 'player';
    }

    applyBtn.addEventListener('click', () => {
      applyMsg.textContent = '';
      if (!isAuthed()) { openModal(loginModal); return; }
      const raw = iframeInput.value.trim();
      if (!raw) { applyMsg.textContent = currentLang === 'fr' ? 'Veuillez coller le code iframe.' : 'Please paste the iframe code.'; return; }
      const res = sanitizeAndExtractIframe(raw);
      if (!res.ok) { applyMsg.textContent = res.msg; applyMsg.className = 'error'; return; }

      // Replace player content
      const newAspect = document.createElement('div');
      newAspect.className = 'player-aspect';
      newAspect.appendChild(res.node);

      const parent = document.querySelector('.player-card');
      const current = parent.querySelector('.player-aspect');
      parent.replaceChild(newAspect, current);

      // Persist last iframe (client-side only)
      localStorage.setItem('lastIframe', res.node.outerHTML);

      applyMsg.textContent = (currentLang === 'fr' ? 'Live mis à jour avec succès !' : 'Live updated successfully!');
      applyMsg.className = 'success';
    });

    clearBtn.addEventListener('click', () => {
      if (!isAuthed()) { openModal(loginModal); return; }
      const parent = document.querySelector('.player-card');
      const placeholderClone = placeholder.cloneNode(true);
      const newAspect = document.createElement('div');
      newAspect.className = 'player-aspect';
      newAspect.appendChild(placeholderClone);

      const current = parent.querySelector('.player-aspect');
      parent.replaceChild(newAspect, current);
      localStorage.removeItem('lastIframe');
      applyMsg.textContent = (currentLang === 'fr' ? 'Lecteur réinitialisé.' : 'Player reset.');
      applyMsg.className = 'success';
    });

    // --- Restore last iframe if exists ---
    const last = localStorage.getItem('lastIframe');
    if (last) {
      const res = sanitizeAndExtractIframe(last);
      if (res.ok) {
        const parent = document.querySelector('.player-card');
        const current = parent.querySelector('.player-aspect');
        const newAspect = document.createElement('div');
        newAspect.className = 'player-aspect';
        newAspect.appendChild(res.node);
        parent.replaceChild(newAspect, current);
      }
    }

    // --- Initialize language ---
    applyLang(currentLang);
    // Bouton retour au live depuis l'admin
document.getElementById('returnLiveBtn').addEventListener('click', () => {
    closeModal(adminModal); // Ferme le panneau admin
    window.scrollTo({ top: 0, behavior: 'smooth' }); // Remonte au lecteur
});

  </script>
</body>
</html>
